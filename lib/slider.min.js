"use strict";function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,s=new Array(t);n<t;n++)s[n]=e[n];return s}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var s=t[n];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}var $=document.querySelector.bind(document),Carousel=function(){function i(e,t){function n(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1;clearTimeout(s.preBtnTimeOut),s.hover=!0,s.preBtnTimeOut=setTimeout(function(){return s.hover=!1},2*s.speed),s.slideFun(e)}var s=this;_classCallCheck(this,i),this.parent=e,null!=t&&t.responsive?this.responsive=t.responsive:this.responsive={default:{show:2,slideby:1}},this.responsive.default||(this.responsive.default={show:(null==t?void 0:t.show)||2,slideby:(null==t?void 0:t.slideby)||1}),this.show=this.responsive.default.show,this.slideby=this.responsive.default.slideby,this.response(),this.speed=(null==t?void 0:t.speed)||500,this.auto=(null==t?void 0:t.auto)||!1,this.auto&&this.autoPlay(),this.styleSheet=document.createElement("style"),document.head.appendChild(this.styleSheet),this.styleSheet.sheet.insertRule("\n        .slider-item {\n            min-width: calc((100% / ".concat(this.show,") - 16px);\n            max-width: calc((100% / ").concat(this.show,") - 16px);\n        }\n        ")),this.hanResize(),this.slide=this.parent.firstElementChild,this.slideItems=this.slide.children,this.total=this.slideItems.length,this.cloneCount=this.getCloneCountForLoop(),this.slideCountNew=this.total+2*this.cloneCount,this.index=this.cloneCount,this.indexMax=Math.max(0,this.slideCountNew-Math.ceil(this.show)),this.mainArr=[],this.curIndex=0,this.initStructure(),this.slideFun(0),this.events();null!=t&&null!=(e=t.nxt)&&e.addEventListener("click",function(){return n()}),null!=t&&null!=(e=t.pre)&&e.addEventListener("click",function(){return n(-1)})}return _createClass(i,[{key:"autoPlay",value:function(){var e,t=this;setInterval(function(){var e;t.hover||t.slideFun((null==(e=t.auto)?void 0:e.deraction)||1)},(null==(e=this.auto)?void 0:e.delay)||2e3)}},{key:"getItemsMax",value:function(){var e=[];return this.show<this.total&&e.push(this.show),e.length||e.push(0),Math.ceil(Math.max.apply(null,e))}},{key:"getCloneCountForLoop",value:function(){var e=this.getItemsMax(),t=Math.ceil((5*e-this.total)/2);return Math.max(e,t)}},{key:"initStructure",value:function(){var n=this;if(this.cloneCount){var e=document.createDocumentFragment(),t=document.createDocumentFragment();this.tempArr=[],_toConsumableArray(this.slideItems).forEach(function(e,t){e.dataset.id=t,n.tempArr.push(t)});for(var s=this.cloneCount;s--;){var i=s%this.total,r=this.slideItems[i].cloneNode(!0),i=this.total-1-i,i=this.slideItems[i].cloneNode(!0);r.classList.add("clone"),t.insertBefore(r,t.firstChild),i.classList.add("clone"),e.appendChild(i)}this.slide.insertBefore(e,this.slide.firstChild),this.slide.appendChild(t),_toConsumableArray(this.slideItems).forEach(function(e){return n.mainArr.push(+e.dataset.id)}),this.resetPos()}}},{key:"resetPos",value:function(){this.curIndex=this.cloneCount,this.slide.style="transform: translate3d(".concat(-100/this.show*this.curIndex,"%, 0px, 0px);transition: all ").concat(this.speed/1e3,"s ease 0s")}},{key:"slideFun",value:function(){var r=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=this.curIndex+this.slideby*e,n=t+this.slideby*e,o=_toConsumableArray(this.tempArr).reverse();this.playBack=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,t=(console.log(r.curIndex),r.mainArr[r.curIndex]-r.slideby),n=r.mainArr[r.curIndex]+r.show+r.slideby;if(n>r.total&&(n%=r.total),t<0&&(t=o[-1*t-1]),-1==e){for(var s=0;s<r.mainArr.length;s++)if(!(s<=r.curIndex)&&r.mainArr[s]==r.mainArr[r.curIndex]&&r.mainArr[s-r.slideby]==t){r.curIndex=s;break}}else for(var i=r.mainArr.length;-1<i;i--)if(!(i>=r.curIndex)&&r.mainArr[i]==r.mainArr[r.curIndex]&&r.mainArr[i+r.show+r.slideby]==n){r.curIndex=i;break}r.slide.style="transform: translate3d(".concat(-100/r.show*r.curIndex,"%, 0px, 0px);transition: all 0s ease 0s")},e&&(0<=t&&t<=this.mainArr.length-this.show&&(this.curIndex=t,this.slide.style="transform: translate3d(".concat(-100/this.show*this.curIndex,"%, 0px, 0px);transition: all ").concat(this.speed/1e3,"s ease 0s")),(n<0||n>this.mainArr.length-this.show)&&setTimeout(function(){return r.playBack(e)},this.speed)),console.log(this.curIndex)}},{key:"response",value:function(){var t,n=this,s=Object.keys(this.responsive).filter(function(e){return+e}).map(function(e){return+e}).sort(function(e,t){return e-t});this.hanResize=function(){var e=[].concat(_toConsumableArray(s),[window.innerWidth]).sort(function(e,t){return e-t}).findIndex(function(e){return e==window.innerWidth})-1,e=(-1!=e?(e=n.responsive[s[e]],n.show=(null==e?void 0:e.show)||n.show,n.slideby=(null==e?void 0:e.slideby)||n.slideby):(n.show=n.responsive.default.show,n.slideby=n.responsive.default.slideby),"calc((100% / ".concat(n.show,") - 16px)")),t=n.styleSheet.sheet.cssRules[0].style;t.maxWidth=e,t.minWidth=e},window.addEventListener("resize",function(e){t&&clearTimeout(t),t=setTimeout(function(){n.hanResize(),n.resetPos()},200)})}},{key:"events",value:function(){function e(e){function t(e){r.temXpos=-100/r.show*i-(s-(e.clientX||e.touches[0].clientX)-n.x)/n.width*100}e.cancelable&&e.preventDefault(),e.stopPropagation(),r.hover=!0;var n=r.parent.getBoundingClientRect(),s=(e.clientX||e.touches[0].clientX)-n.x,i=r.curIndex;r.touchMove=function(e){t(e),r.curIndex=Math.round(Math.abs(r.temXpos/(100/r.show))),(r.temXpos<=(r.mainArr.length-r.show)*(-100/r.show)||0<=r.temXpos)&&(s=(e.clientX||e.touches[0].clientX)-n.x,r.playBack(0<=r.temXpos?-1:1),i=r.curIndex,t(e),console.log(-100/r.show*r.curIndex)),r.slide.style="transform: translate3d(".concat(r.temXpos,"%, 0px, 0px);transition:0s")},window.addEventListener("touchmove",r.touchMove),window.addEventListener("mousemove",r.touchMove)}function t(e){window.removeEventListener("touchmove",r.touchMove),window.removeEventListener("mousemove",r.touchMove),setTimeout(function(){return r.hover=!1},2*r.speed),r.temXpos&&(r.curIndex=Math.round(Math.abs(r.temXpos/(100/r.show))),r.slide.style="transform: translate3d(".concat(-100/r.show*r.curIndex,"%, 0px, 0px);transition: all ").concat(r.speed/1e3/1.5,"s ease 0s"))}var r=this;this.parent.addEventListener("mouseover",function(){r.hover=!0});this.parent.addEventListener("touchstart",e),this.slide.addEventListener("mousedown",e),this.parent.addEventListener("touchend",t),this.parent.addEventListener("mouseup",t),this.parent.addEventListener("mouseleave",function(){r.hover=!1})}}]),i}(),a=new Carousel($(".carousel"),{show:3,responsive:{900:{show:4,slideby:3}},pre:$("#pre"),nxt:$("#nxt"),auto:!0});